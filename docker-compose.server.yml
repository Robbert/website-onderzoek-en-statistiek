version: '3'

services:
  webserver:
    image: registry.gitlab.com/os-amsterdam/website-onderzoek-en-statistiek/server:latest
    restart: unless-stopped
    container_name: os-server
    environment:
      CERTBOT_EMAIL: bas.broekhuizen@gmail.com
      STAGING: 0
    ports:
      - 80:80
      - 443:443
    networks:
      - os-network
    volumes:
      - nginx_secrets:/etc/letsencrypt
      - static_files_acc:/usr/share/nginx/html/static/acc
      # - static_files_prod:/usr/share/nginx/html/static/prod
      - /etc/ssl:/etc/ssl:ro

volumes:
  nginx_secrets:
  static_files_acc:
    external:
      name: acceptance_static_files
  # static_files_prod:
  #   external:
  #     name: production_static_files

networks:
  os-network:
    name: os-network